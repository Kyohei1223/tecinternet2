<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Extra: Identidade e Igualdade em Python</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <!-- Prism.js for Syntax Highlighting (One Dark Theme) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-one-dark.min.css" rel="stylesheet" />
    <style>
        :root {
            --bg-gradient-start: #0f172a;
            --bg-gradient-end: #1e293b;
            --card-bg: rgba(30, 41, 59, 0.7);
            --card-border: rgba(148, 163, 184, 0.1);
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-primary: #38bdf8;
            /* Light Blue */
            --accent-secondary: #818cf8;
            /* Indigo */
            --gradient-main: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            --correct-color: #10b981;
            --wrong-color: #ef4444;
            --code-bg: #282c34;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            padding: 2.5rem;
            background: var(--card-bg);
            border-radius: 20px;
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .header h1 {
            font-size: 2.25rem;
            font-weight: 800;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.75rem;
            letter-spacing: -0.025em;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .stat {
            background: var(--card-bg);
            padding: 1.25rem;
            border-radius: 16px;
            text-align: center;
            border: 1px solid var(--card-border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .stat.reset-btn {
            cursor: pointer;
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
        }

        .stat.reset-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
        }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat.correct .stat-value {
            color: var(--correct-color);
        }

        .stat.wrong .stat-value {
            color: var(--wrong-color);
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 999px;
            height: 8px;
            margin-bottom: 3rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-main);
            border-radius: 999px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Toggle */
        .toggle-container {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 1.5rem;
        }

        .toggle {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-secondary);
            user-select: none;
            transition: color 0.2s;
        }

        .toggle:hover {
            color: var(--text-primary);
        }

        .toggle input {
            accent-color: var(--accent-secondary);
            height: 1.1em;
            width: 1.1em;
        }

        /* Question Card */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .question-card:hover {
            border-color: rgba(56, 189, 248, 0.3);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15);
        }

        .question-card.answered {
            opacity: 0.85;
        }

        .question-card.answered:hover {
            opacity: 1;
        }

        .question-card.answered.correct-answer {
            border-color: rgba(16, 185, 129, 0.4);
        }

        .question-card.answered.wrong-answer {
            border-color: rgba(239, 68, 68, 0.4);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .question-number {
            background: rgba(56, 189, 248, 0.15);
            color: var(--accent-primary);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .question-category {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .question-text {
            font-size: 1.15rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        /* Code Blocks - Inline and Block */
        :not(pre)>code[class*="language-"],
        pre[class*="language-"] {
            background: var(--code-bg) !important;
            border-radius: 8px !important;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Fira Code', monospace !important;
            font-size: 0.9em !important;
            text-shadow: none !important;
        }

        /* Inline code specifically */
        :not(pre)>code {
            padding: 0.2rem 0.4rem !important;
            background: rgba(255, 255, 255, 0.1) !important;
            border-radius: 4px;
            font-size: 0.9em;
            font-family: 'Fira Code', monospace;
            color: #e2e8f0;
        }

        /* Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .option:hover:not(.disabled) {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .option.selected {
            background: rgba(56, 189, 248, 0.15);
            border-color: var(--accent-primary);
        }

        .option.correct {
            background: rgba(16, 185, 129, 0.15);
            border-color: var(--correct-color);
        }

        .option.wrong {
            background: rgba(239, 68, 68, 0.15);
            border-color: var(--wrong-color);
        }

        .option.disabled {
            cursor: default;
        }

        .option-letter {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 1rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .option.selected .option-letter {
            background: var(--accent-primary);
            color: #0f172a;
        }

        .option.correct .option-letter {
            background: var(--correct-color);
            color: #fff;
        }

        .option.wrong .option-letter {
            background: var(--wrong-color);
            color: #fff;
        }

        .option-text {
            flex: 1;
            font-size: 1rem;
        }

        .option-text code {
            /* Small tweak for code inside options */
            background: rgba(0, 0, 0, 0.2) !important;
        }

        /* Feedback */
        .feedback {
            margin-top: 1.5rem;
            padding: 1.25rem;
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .feedback.wrong {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .feedback.correct .feedback-header {
            color: var(--correct-color);
        }

        .feedback.wrong .feedback-header {
            color: var(--wrong-color);
        }

        .feedback-icon {
            margin-right: 0.5rem;
        }

        .explanation {
            font-size: 0.95rem;
            opacity: 0.9;
            margin-top: 0.5rem;
            line-height: 1.6;
        }

        .explanation strong {
            color: var(--accent-secondary);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 3rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-primary {
            background: var(--gradient-main);
            color: white;
            box-shadow: 0 4px 6px rgba(56, 189, 248, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 12px rgba(56, 189, 248, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.75rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .question-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Quiz Extra: Identidade e Igualdade</h1>
            <p>32 Quest√µes sobre Python Internals (v3.10+)</p>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-value" id="total-answered">0</div>
                <div class="stat-label">Respondidas</div>
            </div>
            <div class="stat correct">
                <div class="stat-value" id="total-correct">0</div>
                <div class="stat-label">Correctas</div>
            </div>
            <div class="stat wrong">
                <div class="stat-value" id="total-wrong">0</div>
                <div class="stat-label">Erradas</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="percentage">0%</div>
                <div class="stat-label">Acerto</div>
            </div>
            <div class="stat reset-btn" onclick="resetQuiz()" title="Reiniciar Quiz">
                <div class="stat-value">‚Üª</div>
                <div class="stat-label">Reiniciar</div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
        </div>

        <div class="toggle-container">
            <label class="toggle">
                <input type="checkbox" id="hide-answered">
                <span>Esconder respondidas</span>
            </label>
        </div>

        <div id="questions-container"></div>

        <div class="btn-group">
            <button class="btn btn-secondary" onclick="resetQuiz()">‚Üª Reiniciar Tudo</button>
            <button class="btn btn-primary" onclick="scrollToUnanswered()">‚Üì Pr√≥xima Quest√£o</button>
        </div>
    </div>

    <!-- Prism JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <script>
        // ========================================================================
        // DADOS DAS QUEST√ïES
        // ========================================================================
        const questions = [
            {
                id: 1,
                category: "Listas",
                question: "Considere o seguinte c√≥digo:<br><pre><code class=\"language-python\">x = [1, 2, 3]\ny = [1, 2, 3]\nz = x\nprint(x == y, x is y, x is z)</code></pre><br>Qual √© o output?",
                options: [
                    "True True True",
                    "True False True",
                    "False True True",
                    "True True False",
                ],
                correct: 1,
                explanation: "Listas iguais em conte√∫do (<code>== True</code>), mas objetos distintos na mem√≥ria (<code>is False</code>). Atribui√ß√£o <code>z=x</code> copia a refer√™ncia (<code>is True</code>)."
            },
            {
                id: 2,
                category: "Classes e Sets",
                question: "Considere:<br><pre><code class=\"language-python\">class Item:\n    def __init__(self, nome): self.nome = nome\n    def __eq__(self, outro): return self.nome == outro.nome\n    def __hash__(self): return hash(self.nome)\n\ni1 = Item('A'); i2 = Item('A')\ns = {i1, i2}\nprint(len(s), i1 == i2, i1 is i2)</code></pre>",
                options: [
                    "2 True False",
                    "1 True True",
                    "1 True False",
                    "2 False False",
                ],
                correct: 2,
                explanation: "<code>__eq__</code> torna-os iguais. <code>set</code> usa hash+eq para remover duplicados (tamanho 1). Inst√¢ncias distintas na mem√≥ria (<code>is False</code>)."
            },
            {
                id: 3,
                category: "Classes e Sets",
                question: "Considere:<br><pre><code class=\"language-python\">class Simples:\n    def __init__(self, val): self.val = val\n\ns1 = Simples(10); s2 = Simples(10)\nconjunto = {s1, s2}\nprint(len(conjunto), s1 == s2)</code></pre>",
                options: [
                    "1 True",
                    "2 False",
                    "1 False",
                    "2 True",
                ],
                correct: 1,
                explanation: "Sem <code>__eq__</code>, a igualdade padr√£o √© a identidade. Objetos diferentes -> <code>== False</code> -> mantidos ambos no set."
            },
            {
                id: 4,
                category: "Imutabilidade",
                question: "Considere:<br><pre><code class=\"language-python\">t1 = (1, 2); t2 = (1, 2)\nl1 = [1, 2]; l2 = [1, 2]\nprint(t1 == t2, l1 == l2)</code></pre>",
                options: [
                    "True True",
                    "False False",
                    "True False",
                    "False True",
                ],
                correct: 0,
                explanation: "Tanto tuplos como listas comparam o seu conte√∫do com <code>==</code>."
            },
            {
                id: 5,
                category: "Identity",
                question: "Considere:<br><pre><code class=\"language-python\">a = 'python'\nc = 'py' + 'thon'\nprint(a is c)</code></pre>",
                options: [
                    "False",
                    "True",
                    "Error",
                    "None",
                ],
                correct: 1,
                explanation: "Strings literais curtas s√£o internadas (mesmo id). 'py'+'thon' √© otimizado pelo compilador para 'python'."
            },
            {
                id: 6,
                category: "Identity",
                question: "Considere:<br><pre><code class=\"language-python\">a = None\nb = None\nprint(a == b, a is b)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 0,
                explanation: "<code>None</code> √© um Singleton. Existe apenas uma inst√¢ncia de <code>NoneType</code> no programa."
            },
            {
                id: 7,
                category: "Listas",
                question: "Considere:<br><pre><code class=\"language-python\">lista = [1, 2, 3]\ncopia = lista[:]\nprint(lista == copia, lista is copia)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 1,
                explanation: "Slicing <code>[:]</code> cria uma c√≥pia rasa (novo objeto). Conte√∫do igual, identidade diferente."
            },
            {
                id: 8,
                category: "Imutabilidade",
                question: "Considere:<br><pre><code class=\"language-python\">t = (1, [2, 3])\nt[1].append(4)\nprint(t)</code></pre>",
                options: [
                    "Erro TypeError",
                    "O tuplo permanece (1, [2, 3])",
                    "O tuplo passa a ser (1, [2, 3, 4])",
                    "Erro de sintaxe",
                ],
                correct: 2,
                explanation: "O tuplo √© imut√°vel em refer√™ncias, mas a lista l√° dentro continua mut√°vel. <code>append</code> altera a lista in-place. O ID da lista n√£o muda."
            },
            {
                id: 9,
                category: "Dictionaries",
                question: "Considere:<br><pre><code class=\"language-python\">k1 = (1, 2); k2 = [1, 2]\nd = {}\nd[k1] = 'ok'\nd[k2] = 'erro'</code></pre><br>O que acontece?",
                options: [
                    "O c√≥digo corre sem erros.",
                    "Erro ao adicionar k1.",
                    "Erro TypeError (listas n√£o s√£o hashable).",
                    "Erro de sintaxe.",
                ],
                correct: 2,
                explanation: "Chaves de dicion√°rios t√™m de ser hashable. Tuplos (com conte√∫do imut√°vel) s√£o hashable. Listas s√£o mut√°veis e n√£o hashable."
            },
            {
                id: 10,
                category: "Classes e Sets",
                question: "Se uma classe define <code>__eq__</code> mas n√£o define <code>__hash__</code>, o que acontece ao tentar usar inst√¢ncias num set?",
                options: [
                    "Funciona e o set tem tamanho 1.",
                    "Funciona e o set tem tamanho 2.",
                    "Lan√ßa um TypeError: unhashable type.",
                    "O Python gera um hash aleat√≥rio.",
                ],
                correct: 2,
                explanation: "Ao definir <code>__eq__</code>, o Python define <code>__hash__</code> para <code>None</code> automaticamente, tornando a classe n√£o hashable explicitamente."
            },
            {
                id: 11,
                category: "Identity",
                question: "Considere:<br><pre><code class=\"language-python\">x = True\ny = (10 > 5)\nprint(x is y)</code></pre>",
                options: [
                    "True",
                    "False",
                    "TypeError",
                    "Depende da implementa√ß√£o",
                ],
                correct: 0,
                explanation: "<code>True</code> e <code>False</code> s√£o singletons em Python. Qualquer express√£o booleana verdadeira retorna a mesma inst√¢ncia <code>True</code>."
            },
            {
                id: 12,
                category: "Identity",
                question: "O que representa o valor retornado por <code>id(obj)</code> no CPython?",
                options: [
                    "O valor hash do objeto.",
                    "O endere√ßo de mem√≥ria do objeto.",
                    "Um timestamp.",
                    "Um UID aleat√≥rio.",
                ],
                correct: 1,
                explanation: "No CPython, <code>id()</code> retorna o endere√ßo de mem√≥ria inteiro."
            },
            {
                id: 13,
                category: "Identity",
                question: "Duas inst√¢ncias diferentes da mesma classe gen√©rica t√™m o mesmo <code>__dict__</code>?",
                options: [
                    "Sim, √© o mesmo objeto.",
                    "N√£o, t√™m conte√∫dos iguais mas objetos diferentes.",
                    "N√£o, t√™m conte√∫dos sempre diferentes.",
                    "As classes n√£o usam __dict__.",
                ],
                correct: 1,
                explanation: "Cada objeto tem o seu pr√≥prio dicion√°rio de atributos. Se tiverem atributos iguais, o conte√∫do dos dicts √© igual, mas s√£o objetos <code>dict</code> distintos."
            },
            {
                id: 14,
                category: "Classes e Sets",
                question: "√â poss√≠vel adicionar uma lista a um set? Ex: <code>s = {[1, 2]}</code>",
                options: [
                    "Sim.",
                    "N√£o, lan√ßa TypeError (unhashable).",
                    "Sim, mas a lista fica imut√°vel.",
                    "N√£o, lan√ßa SyntaxError.",
                ],
                correct: 1,
                explanation: "Sets s√≥ podem conter elementos hashable. Listas s√£o mut√°veis, logo n√£o hashable."
            },
            {
                id: 15,
                category: "Listas",
                question: "Considere:<br><pre><code class=\"language-python\">a = [1, 2]\nb = a\nb = [3, 4]\nprint(a)</code></pre>",
                options: [
                    "[3, 4]",
                    "[1, 2]",
                    "[1, 2, 3, 4]",
                    "Erro",
                ],
                correct: 1,
                explanation: "<code>b = [3, 4]</code> √© uma reatribui√ß√£o da vari√°vel <code>b</code> para um novo objeto. A refer√™ncia original em <code>a</code> n√£o √© afetada."
            },
            {
                id: 16,
                category: "Identity",
                question: "A express√£o <code>x is not y</code> √© equivalente a:",
                options: [
                    "<code>x != y</code>",
                    "<code>not (x == y)</code>",
                    "<code>not (x is y)</code>",
                    "<code>id(x) != id(y) + 1</code>",
                ],
                correct: 2,
                explanation: "<code>is not</code> verfica se os objectos n√£o s√£o o mesmo. √â o operador inverso de <code>is</code>."
            },
            {
                id: 17,
                category: "Classes e Sets",
                question: "Para strings s1 e s2, se <code>s1 == s2</code>, ent√£o obrigatoriamente <code>hash(s1) == hash(s2)</code>?",
                options: [
                    "Sim.",
                    "N√£o.",
                    "Depende do sistema operativo.",
                    "Apenas se forem internadas.",
                ],
                correct: 0,
                explanation: "Sim. Propriedade fundamental de hash maps: objetos iguais T√äM de ter o mesmo hash. (O inverso n√£o √© garantido devido a colis√µes)."
            },
            {
                id: 18,
                category: "Classes e Sets",
                question: "O que deve retornar <code>__eq__</code> se n√£o souber comparar com o tipo do outro objeto?",
                options: [
                    "False",
                    "None",
                    "TypeError",
                    "NotImplemented",
                ],
                correct: 3,
                explanation: "Retornar <code>NotImplemented</code> sinaliza ao Python para tentar a compara√ß√£o reversa (e.g. <code>outro.__eq__(self)</code>) ou usar identidade como fallback."
            },
            {
                id: 19,
                category: "Classes e Sets",
                question: "Considere:<br><pre><code class=\"language-python\">class MeuInt(int): pass\na = MeuInt(5); b = MeuInt(5)\nprint(a == b, a is b)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 1,
                explanation: "Herdam a igualdade de <code>int</code> (<code>5 == 5</code> True), mas s√£o novas inst√¢ncias na mem√≥ria."
            },
            {
                id: 20,
                category: "Identity",
                question: "Considere:<br><pre><code class=\"language-python\">def func(): pass\nf1 = func\nf2 = func\nprint(f1 is f2)</code></pre>",
                options: [
                    "True",
                    "False",
                    "None",
                    "Erro",
                ],
                correct: 0,
                explanation: "Fun√ß√µes s√£o objetos. <code>f1</code> e <code>f2</code> s√£o apenas nomes diferentes para a mesm√≠ssima fun√ß√£o na mem√≥ria."
            },
            // NOVAS QUEST√ïES (21-30)
            {
                id: 21,
                category: "Identity",
                question: "Small Integer Caching. Considere:<br><pre><code class=\"language-python\">a = 256\nb = 256\nprint(a is b)</code></pre>",
                options: [
                    "True",
                    "False",
                    "Depende da mem√≥ria RAM",
                    "Erro",
                ],
                correct: 0,
                explanation: "O CPython faz 'cache' (interning) de inteiros pequenos (geralmente entre -5 e 256). Portanto, referenciam o mesmo objeto."
            },
            {
                id: 22,
                category: "Identity",
                question: "Inteiros maiores. Considere (num REPL padr√£o):<br><pre><code class=\"language-python\">a = 1000\nb = 1000\nprint(a is b)</code></pre>",
                options: [
                    "True",
                    "False",
                    "Erro",
                    "None",
                ],
                correct: 1,
                explanation: "Para inteiros fora do range de cache (-5 a 256), o Python geralmente cria novos objetos, a n√£o ser que haja otimiza√ß√£o do compilador (no mesmo bloco). Em instru√ß√µes separadas no REPL, √© False."
            },
            {
                id: 23,
                category: "Float",
                question: "NaN (Not a Number). Considere:<br><pre><code class=\"language-python\">x = float('nan')\nprint(x == x, x is x)</code></pre>",
                options: [
                    "True True",
                    "False False",
                    "False True",
                    "True False",
                ],
                correct: 2,
                explanation: "Por defini√ß√£o IEEE 754, NaN != NaN (da√≠ <code>x == x</code> ser False). Mas <code>x is x</code> √© True porque √© o mesmo objeto em mem√≥ria."
            },
            {
                id: 24,
                category: "Identity",
                question: "Bool vs Int. Considere:<br><pre><code class=\"language-python\">print(True == 1, True is 1)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 1,
                explanation: "<code>True</code> vale 1, logo <code>==</code> √© True. Mas <code>True</code> √© tipo <code>bool</code> e <code>1</code> √© tipo <code>int</code>, logo s√£o objetos diferentes (is False)."
            },
            {
                id: 25,
                category: "Coercion",
                question: "Num√©ricos mistos.<br><pre><code class=\"language-python\">print(1.0 == 1, 1.0 is 1)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 1,
                explanation: "Valores s√£o numericamente iguais, mas tipos diferentes (float vs int) implicam objetos diferentes (is False)."
            },
            {
                id: 26,
                category: "Interning",
                question: "Tuplos vazios.<br><pre><code class=\"language-python\">t1 = ()\nt2 = tuple()\nprint(t1 is t2)</code></pre>",
                options: [
                    "True",
                    "False",
                    "Erro",
                    "Depende",
                ],
                correct: 0,
                explanation: "O Python faz interning do tuplo vazio. S√≥ existe um <code>()</code> na mem√≥ria."
            },
            {
                id: 27,
                category: "Classes",
                question: "Instancia√ß√£o de object.<br><pre><code class=\"language-python\">o1 = object()\no2 = object()\nprint(o1 == o2, o1 is o2)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False False",
                    "False True",
                ],
                correct: 2,
                explanation: "<code>object()</code> cria sempre uma nova inst√¢ncia base. O <code>==</code> default para object √© identidade (is), logo ambos d√£o False."
            },
            {
                id: 28,
                category: "Identity",
                question: "Operadores encadeados.<br><pre><code class=\"language-python\">print(1 < 2 == 2)</code></pre>",
                options: [
                    "True",
                    "False",
                    "Erro",
                    "1",
                ],
                correct: 0,
                explanation: "Encadeamento: equivale a <code>(1 < 2) and (2 == 2)</code>. True and True -> True."
            },
            {
                id: 29,
                category: "Mutability",
                question: "Fun√ß√£o id(). O valor de <code>id(x)</code> pode mudar durante a vida do objeto x?",
                options: [
                    "Sim, se o objeto for mut√°vel.",
                    "Sim, se o garbage collector correr.",
                    "N√£o, √© constante durante o tempo de vida do objeto.",
                    "Sim, em Python 3.10+.",
                ],
                correct: 2,
                explanation: "O id √© a 'identidade' (endere√ßo mem√≥ria no CPython) e √© garantidamente constante enquanto o objeto existir."
            },
            {
                id: 30,
                category: "Identity",
                question: "Interning manual. Como for√ßar interning de uma string din√¢mica?",
                options: [
                    "str.cache(s)",
                    "sys.intern(s)",
                    "s.intern()",
                    "N√£o √© poss√≠vel",
                ],
                correct: 1,
                explanation: "<code>sys.intern()</code> permite for√ßar que uma string criada dinamicamente seja guardada na tabela interna de strings √∫nicas."
            },
            {
                id: 31,
                category: "Common Pitfalls",
                question: "Argumentos por defeito mut√°veis. Considere:<br><pre><code class=\"language-python\">def f(l=[]):\n    l.append(1)\n    return l\nprint(f() is f())</code></pre>",
                options: [
                    "True",
                    "False",
                    "Erro",
                    "Depende",
                ],
                correct: 0,
                explanation: "O argumento por defeito <code>l=[]</code> √© criado <strong>apenas uma vez</strong> na defini√ß√£o da fun√ß√£o. Todas as chamadas usam o <strong>mesmo</strong> objeto lista."
            },
            {
                id: 32,
                category: "Types",
                question: "Identity de Tipos. Considere:<br><pre><code class=\"language-python\">class A: pass\nclass B(A): pass\nb = B()\nprint(type(b) is A, isinstance(b, A))</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 2,
                explanation: "<code>type(b)</code> √© <code>B</code>, e <code>B</code> n√£o √© o mesmo objeto que <code>A</code> (<code>is</code> False). Mas <code>b</code> √© inst√¢ncia de <code>A</code> (<code>isinstance</code> True)."
            }
        ];

        // ========================================================================
        // ESTADO APLICA√á√ÉO
        // ========================================================================
        let answers = {};

        // ========================================================================
        // FUN√á√ïES
        // ========================================================================

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            const hideAnswered = document.getElementById('hide-answered').checked;

            let filtered = questions;
            if (hideAnswered) {
                filtered = filtered.filter(q => answers[q.id] === undefined);
            }

            container.innerHTML = filtered.length
                ? filtered.map(q => createQuestionCard(q)).join('')
                : '<p style="text-align:center; padding: 2rem; color: var(--text-secondary)">Todas as quest√µes apresentadas foram respondidas.</p>';

            // Re-run Prism highlighting on new elements
            Prism.highlightAll();
        }

        function createQuestionCard(q) {
            const answer = answers[q.id];
            const isAnswered = answer !== undefined;
            const isCorrect = answer === q.correct;

            let cardClass = 'question-card';
            if (isAnswered) {
                cardClass += ' answered ' + (isCorrect ? 'correct-answer' : 'wrong-answer');
            }

            return `
                <div class="${cardClass}" id="question-${q.id}">
                    <div class="question-header">
                        <span class="question-number">Quest√£o ${q.id}</span>
                        <span class="question-category">${q.category}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, i) => createOption(q.id, opt, i, q.correct, answer)).join('')}
                    </div>
                    ${isAnswered ? createFeedback(isCorrect, q.options[q.correct], q.explanation) : ''}
                </div>
            `;
        }

        function createOption(qId, text, index, correct, answer) {
            const isAnswered = answer !== undefined;
            const isSelected = answer === index;
            const isCorrectOption = correct === index;

            let optClass = 'option';
            if (isAnswered) {
                optClass += ' disabled';
                if (isCorrectOption) optClass += ' correct';
                else if (isSelected) optClass += ' wrong';
            }

            // Converter c√≥digo nas op√ß√µes para usar code tags do Prism lightweight se necess√°rio
            // Mas as op√ß√µes j√° v√™m com HTML <code> b√°sico. 
            // Vamos assumir que o CSS trata do b√°sico ou o user quer highlight real l√° tamb√©m?
            // Para simplicidade, nas op√ß√µes mantemos simples ou usamos Prism inline se houver <code>

            const onclick = isAnswered ? '' : `onclick="selectAnswer(${qId}, ${index})"`;
            const letters = ['A', 'B', 'C', 'D', 'E'];

            return `
                <div class="${optClass}" ${onclick}>
                    <span class="option-letter">${letters[index]}</span>
                    <span class="option-text">${text}</span>
                </div>
            `;
        }

        function createFeedback(isCorrect, correctText, explanation) {
            const icon = isCorrect ? 'Correcto!' : 'Errado!';

            return `
                <div class="feedback show ${isCorrect ? 'correct' : 'wrong'}">
                    <div class="feedback-header">
                        <span class="feedback-icon">${isCorrect ? '‚úÖ' : '‚ùå'}</span>
                        ${icon}
                    </div>
                    <div style="margin-bottom:0.5rem">
                        ${isCorrect ? 'Muito bem!' : 'A resposta correta √©: <strong>' + correctText + '</strong>'}
                    </div>
                    ${explanation ? `<div class="explanation">üí° <strong>Explica√ß√£o:</strong> ${explanation}</div>` : ''}
                </div>
            `;
        }

        function selectAnswer(qId, optionIndex) {
            answers[qId] = optionIndex;
            saveProgress();
            renderQuestions(); // Re-render to show feedback and lock options
            updateStats();
        }

        function updateStats() {
            const total = Object.keys(answers).length;
            const correct = questions.filter(q => answers[q.id] === q.correct).length;
            const wrong = total - correct;
            const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;

            document.getElementById('total-answered').textContent = total;
            document.getElementById('total-correct').textContent = correct;
            document.getElementById('total-wrong').textContent = wrong;
            document.getElementById('percentage').textContent = percentage + '%';
            document.getElementById('progress-bar').style.width = (total / questions.length * 100) + '%';
        }

        function scrollToUnanswered() {
            const unanswered = questions.find(q => answers[q.id] === undefined);
            if (unanswered) {
                const element = document.getElementById(`question-${unanswered.id}`);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            } else {
                alert('üéâ Parab√©ns! Respondeste a todas as quest√µes!');
            }
        }

        function resetQuiz() {
            if (confirm('Tens a certeza que queres reiniciar o quiz?')) {
                answers = {};
                localStorage.removeItem('quizProgressExtraIdentityV2');
                renderQuestions();
                updateStats();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function saveProgress() {
            localStorage.setItem('quizProgressExtraIdentityV2', JSON.stringify(answers));
        }

        function loadProgress() {
            const saved = localStorage.getItem('quizProgressExtraIdentityV2');
            if (saved) {
                answers = JSON.parse(saved);
            }
        }

        // ========================================================================
        // INICIALIZA√á√ÉO
        // ========================================================================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderQuestions();
            updateStats();
            document.getElementById('hide-answered').addEventListener('change', renderQuestions);
        });
    </script>
</body>

</html>