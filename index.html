<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Extra: Identidade e Igualdade em Python</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #3232a0 0%, #16213e 50%, #06182d 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            border-radius: 15px;
            text-align: center;
            min-width: 120px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }

        .stat.reset-btn {
            cursor: pointer;
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
        }

        .stat.reset-btn:hover {
            background: rgba(239, 68, 68, 0.4);
            border-color: rgba(239, 68, 68, 0.6);
            transform: scale(1.05);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 0.25rem;
        }

        .stat.correct .stat-value {
            color: #156d50;
        }

        .stat.wrong .stat-value {
            color: #ef4444;
        }

        /* Category Filter */
        .category-filter {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .category-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .category-btn:hover,
        .category-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* Question Card */
        .question-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }

        .question-card:hover {
            border-color: rgba(102, 126, 234, 0.3);
        }

        .question-card.answered {
            opacity: 0.7;
        }

        .question-card.answered.correct-answer {
            border-color: #10b981;
            opacity: 1;
        }

        .question-card.answered.wrong-answer {
            border-color: #ef4444;
            opacity: 1;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .question-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .question-category {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .question-text {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .question-text code {
            background: rgba(102, 126, 234, 0.2);
            padding: 0.2rem 0.5rem;
            border-radius: 5px;
            font-family: 'Fira Code', monospace;
            font-size: 0.95rem;
        }

        .code-block {
            background: #1e1e3f;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        /* Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .option:hover:not(.disabled) {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .option.disabled {
            cursor: not-allowed;
        }

        .option.selected {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        .option.correct {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10b981;
        }

        .option.wrong {
            background: rgba(239, 68, 68, 0.2);
            border-color: #ef4444;
        }

        .option-letter {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .option.correct .option-letter {
            background: #10b981;
        }

        .option.wrong .option-letter {
            background: #ef4444;
        }

        .option-text {
            flex: 1;
            line-height: 1.5;
        }

        .option-text code {
            background: rgba(102, 126, 234, 0.2);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
        }

        /* Feedback */
        .feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 10px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .feedback.wrong {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .feedback-icon {
            font-size: 1.2rem;
            margin-right: 0.5rem;
        }

        .explanation {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.85);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .stats-bar {
                gap: 1rem;
            }

            .stat {
                padding: 0.75rem 1.25rem;
                min-width: 100px;
            }

            .question-card {
                padding: 1.5rem;
            }

            .question-text {
                font-size: 1rem;
            }
        }

        /* Hide answered toggle */
        .toggle-container {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .toggle input {
            accent-color: #667eea;
        }

        /* USER CUSTOM THEME */
        body {
            background: linear-gradient(135deg, #280b47 0%, #16213e 50%, #031d36 100%);
            background-color: #10241d;
            color: #fff;
        }

        .question-card {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Quiz Extra: Identidade e Igualdade em Python</h1>
            <p>Prepara√ß√£o para Exame ‚Ä¢ 20 Quest√µes Focadas</p>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-value" id="total-answered">0</div>
                <div class="stat-label">Respondidas</div>
            </div>
            <div class="stat correct">
                <div class="stat-value" id="total-correct">0</div>
                <div class="stat-label">Correctas</div>
            </div>
            <div class="stat wrong">
                <div class="stat-value" id="total-wrong">0</div>
                <div class="stat-label">Erradas</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="percentage">0%</div>
                <div class="stat-label">Acerto</div>
            </div>
            <div class="stat reset-btn" onclick="resetQuiz()" title="Reiniciar Quiz">
                <div class="stat-value">üîÑ</div>
                <div class="stat-label">Reiniciar</div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
        </div>

        <div class="category-filter" id="category-filter">
            <button class="category-btn active" data-category="all">Todas</button>
        </div>

        <div class="toggle-container">
            <label class="toggle">
                <input type="checkbox" id="hide-answered">
                Esconder respondidas
            </label>
        </div>

        <div id="questions-container"></div>

        <div class="btn-group">
            <button class="btn btn-secondary" onclick="resetQuiz()">üîÑ Reiniciar Quiz</button>
            <button class="btn btn-primary" onclick="scrollToUnanswered()">‚¨áÔ∏è Pr√≥xima Quest√£o</button>
        </div>
    </div>

    <script>
        // ========================================================================
        // DADOS DAS QUEST√ïES
        // ========================================================================
        const questions = [
            {
                id: 1,
                category: "Listas",
                question: "Considere o seguinte c√≥digo:<br><pre><code>x = [1, 2, 3]\ny = [1, 2, 3]\nz = x\nprint(x == y, x is y, x is z)</code></pre><br>Qual √© o output?",
                options: [
                    "True True True",
                    "True False True",
                    "False True True",
                    "True True False",
                ],
                correct: 1,
                explanation: "Listas iguais em conte√∫do (<code>== True</code>), mas objetos distintos na mem√≥ria (<code>is False</code>). Atribui√ß√£o <code>z=x</code> copia a refer√™ncia (<code>is True</code>)."
            },
            {
                id: 2,
                category: "Classes e Sets",
                question: "Considere:<br><pre><code>class Item:\n    def __init__(self, nome): self.nome = nome\n    def __eq__(self, outro): return self.nome == outro.nome\n    def __hash__(self): return hash(self.nome)\n\ni1 = Item('A'); i2 = Item('A')\ns = {i1, i2}\nprint(len(s), i1 == i2, i1 is i2)</code></pre>",
                options: [
                    "2 True False",
                    "1 True True",
                    "1 True False",
                    "2 False False",
                ],
                correct: 2,
                explanation: "<code>__eq__</code> torna-os iguais. <code>set</code> usa hash+eq para remover duplicados (tamanho 1). Inst√¢ncias distintas na mem√≥ria (<code>is False</code>)."
            },
            {
                id: 3,
                category: "Classes e Sets",
                question: "Considere:<br><pre><code>class Simples:\n    def __init__(self, val): self.val = val\n\ns1 = Simples(10); s2 = Simples(10)\nconjunto = {s1, s2}\nprint(len(conjunto), s1 == s2)</code></pre>",
                options: [
                    "1 True",
                    "2 False",
                    "1 False",
                    "2 True",
                ],
                correct: 1,
                explanation: "Sem <code>__eq__</code>, a igualdade padr√£o √© a identidade. Objetos diferentes -> <code>== False</code> -> mantidos ambos no set."
            },
            {
                id: 4,
                category: "Imutabilidade",
                question: "Considere:<br><pre><code>t1 = (1, 2); t2 = (1, 2)\nl1 = [1, 2]; l2 = [1, 2]\nprint(t1 == t2, l1 == l2)</code></pre>",
                options: [
                    "True True",
                    "False False",
                    "True False",
                    "False True",
                ],
                correct: 0,
                explanation: "Tanto tuplos como listas comparam o seu conte√∫do com <code>==</code>."
            },
            {
                id: 5,
                category: "Identity",
                question: "Considere:<br><pre><code>a = 'python'\nc = 'py' + 'thon'\nprint(a is c)</code></pre>",
                options: [
                    "False",
                    "True",
                    "Error",
                    "None",
                ],
                correct: 1,
                explanation: "Strings literais curtas s√£o internadas (mesmo id). 'py'+'thon' √© otimizado pelo compilador para 'python'."
            },
            {
                id: 6,
                category: "Identity",
                question: "Considere:<br><pre><code>a = None\nb = None\nprint(a == b, a is b)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 0,
                explanation: "<code>None</code> √© um Singleton. Existe apenas uma inst√¢ncia de <code>NoneType</code> no programa."
            },
            {
                id: 7,
                category: "Listas",
                question: "Considere:<br><pre><code>lista = [1, 2, 3]\ncopia = lista[:]\nprint(lista == copia, lista is copia)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 1,
                explanation: "Slicing <code>[:]</code> cria uma c√≥pia rasa (novo objeto). Conte√∫do igual, identidade diferente."
            },
            {
                id: 8,
                category: "Imutabilidade",
                question: "Considere:<br><pre><code>t = (1, [2, 3])\nt[1].append(4)\nprint(t)</code></pre>",
                options: [
                    "Erro TypeError: 'tuple' object does not support item assignment",
                    "O tuplo permanece (1, [2, 3]) pois √© imut√°vel",
                    "O tuplo passa a ser (1, [2, 3, 4])",
                    "Erro de sintaxe",
                ],
                correct: 2,
                explanation: "O tuplo √© imut√°vel, mas a lista l√° dentro continua mut√°vel. <code>append</code> altera a lista in-place. O tuplo continua a apontar para a *mesma* lista."
            },
            {
                id: 9,
                category: "Dictionaries",
                question: "Considere:<br><pre><code>k1 = (1, 2); k2 = [1, 2]\nd = {}\nd[k1] = 'ok'\nd[k2] = 'erro'</code></pre><br>O que acontece?",
                options: [
                    "O c√≥digo corre sem erros.",
                    "Erro ao adicionar k1 (tuplo).",
                    "Erro TypeError (listas n√£o s√£o hashable).",
                    "Erro de sintaxe.",
                ],
                correct: 2,
                explanation: "Chaves de dicion√°rios t√™m de ser hashable. Tuplos (com conte√∫do imut√°vel) s√£o hashable. Listas s√£o mut√°veis e n√£o hashable."
            },
            {
                id: 10,
                category: "Classes e Sets",
                question: "Se uma classe define <code>__eq__</code> mas n√£o define <code>__hash__</code>, o que acontece ao tentar usar inst√¢ncias num set?",
                options: [
                    "Funciona e o set tem tamanho 1.",
                    "Funciona e o set tem tamanho 2.",
                    "Lan√ßa um TypeError: unhashable type.",
                    "O Python gera um hash aleat√≥rio.",
                ],
                correct: 2,
                explanation: "Ao definir <code>__eq__</code>, o Python define <code>__hash__</code> para <code>None</code> automaticamente, tornando a classe n√£o hashable."
            },
            {
                id: 11,
                category: "Identity",
                question: "Considere:<br><pre><code>x = True\ny = (10 > 5)\nprint(x is y)</code></pre>",
                options: [
                    "True",
                    "False",
                    "TypeError",
                    "Depende da implementa√ß√£o",
                ],
                correct: 0,
                explanation: "<code>True</code> e <code>False</code> s√£o singletons em Python 3."
            },
            {
                id: 12,
                category: "Identity",
                question: "O que representa o valor retornado por <code>id(obj)</code> no CPython?",
                options: [
                    "O valor hash do objeto.",
                    "O endere√ßo de mem√≥ria do objeto.",
                    "Um timestamp.",
                    "Um n√∫mero aleat√≥rio.",
                ],
                correct: 1,
                explanation: "No CPython, <code>id()</code> retorna o endere√ßo de mem√≥ria."
            },
            {
                id: 13,
                category: "Identity",
                question: "Duas inst√¢ncias diferentes da mesma classe gen√©rica t√™m o mesmo <code>__dict__</code>?",
                options: [
                    "Sim, √© o mesmo objeto.",
                    "N√£o, t√™m conte√∫dos iguais mas objetos diferentes (is False).",
                    "N√£o, t√™m conte√∫dos diferentes.",
                    "Erro de acesso.",
                ],
                correct: 1,
                explanation: "Cada objeto tem o seu pr√≥prio dicion√°rio de atributos. Se tiverem atributos iguais, o conte√∫do √© igual (<code>==</code>), mas s√£o dicts diferentes (<code>is</code>)."
            },
            {
                id: 14,
                category: "Classes e Sets",
                question: "√â poss√≠vel adicionar uma lista a um set? Ex: <code>s = {[1, 2]}</code>",
                options: [
                    "Sim.",
                    "N√£o, lan√ßa TypeError (unhashable).",
                    "Sim, mas a lista fica imut√°vel.",
                    "N√£o, lan√ßa SyntaxError.",
                ],
                correct: 1,
                explanation: "Sets s√≥ podem conter elementos hashable. Listas s√£o mut√°veis, logo n√£o hashable."
            },
            {
                id: 15,
                category: "Listas",
                question: "Considere:<br><pre><code>a = [1, 2]\nb = a\nb = [3, 4]\nprint(a)</code></pre>",
                options: [
                    "[3, 4]",
                    "[1, 2]",
                    "[1, 2, 3, 4]",
                    "Erro",
                ],
                correct: 1,
                explanation: "<code>b = [3, 4]</code> faz <code>b</code> apontar para uma *nova* lista. A refer√™ncia original em <code>a</code> n√£o √© afetada."
            },
            {
                id: 16,
                category: "Identity",
                question: "A express√£o <code>x is not y</code> √© equivalente a:",
                options: [
                    "<code>x != y</code>",
                    "<code>not (x == y)</code>",
                    "<code>not (x is y)</code>",
                    "<code>id(x) != id(y) + 1</code>",
                ],
                correct: 2,
                explanation: "<code>is not</code> √© o operador inverso de <code>is</code>."
            },
            {
                id: 17,
                category: "Classes e Sets",
                question: "Para strings s1 e s2, se <code>s1 == s2</code>, ent√£o obrigatoriamente <code>hash(s1) == hash(s2)</code>?",
                options: [
                    "Sim.",
                    "N√£o.",
                    "Depende do sistema operativo.",
                    "Apenas se forem internadas.",
                ],
                correct: 0,
                explanation: "Propriedade fundamental: objetos iguais devem ter o mesmo hash."
            },
            {
                id: 18,
                category: "Classes e Sets",
                question: "O que deve retornar <code>__eq__</code> se n√£o souber comparar com o tipo do outro objeto?",
                options: [
                    "False",
                    "None",
                    "TypeError",
                    "NotImplemented",
                ],
                correct: 3,
                explanation: "Retornar <code>NotImplemented</code> permite ao Python tentar a compara√ß√£o reversa no outro objeto."
            },
            {
                id: 19,
                category: "Classes e Sets",
                question: "Considere:<br><pre><code>class MeuInt(int): pass\na = MeuInt(5); b = MeuInt(5)\nprint(a == b, a is b)</code></pre>",
                options: [
                    "True True",
                    "True False",
                    "False True",
                    "False False",
                ],
                correct: 1,
                explanation: "Herdam a igualdade de <code>int</code> (<code>5 == 5</code> True), mas s√£o novas inst√¢ncias na mem√≥ria."
            },
            {
                id: 20,
                category: "Identity",
                question: "Considere:<br><pre><code>def func(): pass\nf1 = func\nf2 = func\nprint(f1 is f2)</code></pre>",
                options: [
                    "True",
                    "False",
                    "None",
                    "Erro",
                ],
                correct: 0,
                explanation: "Fun√ß√µes s√£o objetos. f1 e f2 referenciam a mesma defini√ß√£o de fun√ß√£o."
            }
        ];


        // ========================================================================
        // ESTADO DA APLICA√á√ÉO
        // ========================================================================
        let answers = {};
        let categories = [...new Set(questions.map(q => q.category))];
        let currentFilter = 'all';

        // ========================================================================
        // FUN√á√ïES
        // ========================================================================

        function initCategoryFilter() {
            const container = document.getElementById('category-filter');
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.dataset.category = cat;
                btn.textContent = cat;
                btn.onclick = () => filterByCategory(cat);
                container.appendChild(btn);
            });
        }

        function filterByCategory(category) {
            currentFilter = category;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.category === category);
            });
            renderQuestions();
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            const hideAnswered = document.getElementById('hide-answered').checked;

            let filtered = questions;
            if (currentFilter !== 'all') {
                filtered = questions.filter(q => q.category === currentFilter);
            }
            if (hideAnswered) {
                filtered = filtered.filter(q => answers[q.id] === undefined);
            }

            container.innerHTML = filtered.map(q => createQuestionCard(q)).join('');
        }

        function createQuestionCard(q) {
            const answer = answers[q.id];
            const isAnswered = answer !== undefined;
            const isCorrect = answer === q.correct;

            let cardClass = 'question-card';
            if (isAnswered) {
                cardClass += ' answered ' + (isCorrect ? 'correct-answer' : 'wrong-answer');
            }

            return `
                <div class="${cardClass}" id="question-${q.id}">
                    <div class="question-header">
                        <span class="question-number">Quest√£o ${q.id}</span>
                        <span class="question-category">${q.category}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, i) => createOption(q.id, opt, i, q.correct, answer)).join('')}
                    </div>
                    ${isAnswered ? createFeedback(isCorrect, q.options[q.correct], q.explanation) : ''}
                </div>
            `;
        }

        function createOption(qId, text, index, correct, answer) {
            const isAnswered = answer !== undefined;
            const isSelected = answer === index;
            const isCorrectOption = correct === index;

            let optClass = 'option';
            if (isAnswered) {
                optClass += ' disabled';
                if (isCorrectOption) optClass += ' correct';
                else if (isSelected) optClass += ' wrong';
            }

            const letters = ['A', 'B', 'C', 'D', 'E'];
            const onclick = isAnswered ? '' : `onclick="selectAnswer(${qId}, ${index})"`;

            return `
                <div class="${optClass}" ${onclick}>
                    <span class="option-letter">${letters[index]}</span>
                    <span class="option-text">${text}</span>
                </div>
            `;
        }

        function createFeedback(isCorrect, correctText, explanation) {
            const icon = isCorrect ? '‚úÖ' : '‚ùå';
            const message = isCorrect
                ? 'Correcto! Boa!'
                : `Errado. A resposta correta √©: ${correctText}`;

            const explText = explanation ? `<div class="explanation">üí° <strong>Explica√ß√£o:</strong> ${explanation}</div>` : '';

            return `
                <div class="feedback show ${isCorrect ? 'correct' : 'wrong'}">
                    <span class="feedback-icon">${icon}</span>
                    ${message}
                    ${explText}
                </div>
            `;
        }

        function selectAnswer(qId, optionIndex) {
            answers[qId] = optionIndex;
            saveProgress();
            renderQuestions();
            updateStats();
        }

        function updateStats() {
            const total = Object.keys(answers).length;
            const correct = questions.filter(q => answers[q.id] === q.correct).length;
            const wrong = total - correct;
            const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;

            document.getElementById('total-answered').textContent = total;
            document.getElementById('total-correct').textContent = correct;
            document.getElementById('total-wrong').textContent = wrong;
            document.getElementById('percentage').textContent = percentage + '%';
            document.getElementById('progress-bar').style.width = (total / questions.length * 100) + '%';
        }

        function scrollToUnanswered() {
            const unanswered = questions.find(q => answers[q.id] === undefined);
            if (unanswered) {
                const element = document.getElementById(`question-${unanswered.id}`);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            } else {
                alert('üéâ Parab√©ns! Respondeste a todas as quest√µes!');
            }
        }

        function resetQuiz() {
            if (confirm('Tens a certeza que queres reiniciar o quiz? Todo o progresso ser√° perdido.')) {
                answers = {};
                localStorage.removeItem('quizProgressExtraIdentity');
                renderQuestions();
                updateStats();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function saveProgress() {
            localStorage.setItem('quizProgressExtraIdentity', JSON.stringify(answers));
        }

        function loadProgress() {
            const saved = localStorage.getItem('quizProgressExtraIdentity');
            if (saved) {
                answers = JSON.parse(saved);
            }
        }

        // ========================================================================
        // INICIALIZA√á√ÉO
        // ========================================================================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            initCategoryFilter();
            renderQuestions();
            updateStats();

            document.getElementById('hide-answered').addEventListener('change', renderQuestions);
        });
    </script>
</body>

</html>
