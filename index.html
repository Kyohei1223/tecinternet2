<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz: Sistemas Multimédia I (SMUL1)</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <!-- Prism.js for Syntax Highlighting (One Dark Theme) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-one-dark.min.css" rel="stylesheet" />
    <style>
        :root {
            --bg-gradient-start: #0f172a;
            --bg-gradient-end: #1e293b;
            --card-bg: rgba(30, 41, 59, 0.7);
            --card-border: rgba(148, 163, 184, 0.1);
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-primary: #38bdf8;
            /* Light Blue */
            --accent-secondary: #818cf8;
            /* Indigo */
            --gradient-main: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            --correct-color: #10b981;
            --wrong-color: #ef4444;
            --code-bg: #282c34;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            padding: 2.5rem;
            background: var(--card-bg);
            border-radius: 20px;
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .header h1 {
            font-size: 2.25rem;
            font-weight: 800;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.75rem;
            letter-spacing: -0.025em;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .stat {
            background: var(--card-bg);
            padding: 1.25rem;
            border-radius: 16px;
            text-align: center;
            border: 1px solid var(--card-border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .stat.reset-btn {
            cursor: pointer;
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
        }

        .stat.reset-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
        }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat.correct .stat-value {
            color: var(--correct-color);
        }

        .stat.wrong .stat-value {
            color: var(--wrong-color);
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 999px;
            height: 8px;
            margin-bottom: 3rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-main);
            border-radius: 999px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Toggle */
        .toggle-container {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 1.5rem;
        }

        .toggle {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-secondary);
            user-select: none;
            transition: color 0.2s;
        }

        .toggle:hover {
            color: var(--text-primary);
        }

        .toggle input {
            accent-color: var(--accent-secondary);
            height: 1.1em;
            width: 1.1em;
        }

        /* Question Card */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .question-card:hover {
            border-color: rgba(56, 189, 248, 0.3);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15);
        }

        .question-card.answered {
            opacity: 0.85;
        }

        .question-card.answered:hover {
            opacity: 1;
        }

        .question-card.answered.correct-answer {
            border-color: rgba(16, 185, 129, 0.4);
        }

        .question-card.answered.wrong-answer {
            border-color: rgba(239, 68, 68, 0.4);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .question-number {
            background: rgba(56, 189, 248, 0.15);
            color: var(--accent-primary);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .question-category {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .question-text {
            font-size: 1.15rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        /* Code Blocks - Inline and Block */
        :not(pre)>code[class*="language-"],
        pre[class*="language-"] {
            background: var(--code-bg) !important;
            border-radius: 8px !important;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Fira Code', monospace !important;
            font-size: 0.9em !important;
            text-shadow: none !important;
        }

        /* Inline code specifically */
        :not(pre)>code {
            padding: 0.2rem 0.4rem !important;
            background: rgba(255, 255, 255, 0.1) !important;
            border-radius: 4px;
            font-size: 0.9em;
            font-family: 'Fira Code', monospace;
            color: #e2e8f0;
        }

        /* Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .option:hover:not(.disabled) {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .option.selected {
            background: rgba(56, 189, 248, 0.15);
            border-color: var(--accent-primary);
        }

        .option.correct {
            background: rgba(16, 185, 129, 0.15);
            border-color: var(--correct-color);
        }

        .option.wrong {
            background: rgba(239, 68, 68, 0.15);
            border-color: var(--wrong-color);
        }

        .option.disabled {
            cursor: default;
        }

        .option-letter {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 1rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .option.selected .option-letter {
            background: var(--accent-primary);
            color: #0f172a;
        }

        .option.correct .option-letter {
            background: var(--correct-color);
            color: #fff;
        }

        .option.wrong .option-letter {
            background: var(--wrong-color);
            color: #fff;
        }

        .option-text {
            flex: 1;
            font-size: 1rem;
        }

        .option-text code {
            /* Small tweak for code inside options */
            background: rgba(0, 0, 0, 0.2) !important;
        }

        /* Feedback */
        .feedback {
            margin-top: 1.5rem;
            padding: 1.25rem;
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .feedback.wrong {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .feedback.correct .feedback-header {
            color: var(--correct-color);
        }

        .feedback.wrong .feedback-header {
            color: var(--wrong-color);
        }

        .feedback-icon {
            margin-right: 0.5rem;
        }

        .explanation {
            font-size: 0.95rem;
            opacity: 0.9;
            margin-top: 0.5rem;
            line-height: 1.6;
        }

        .explanation strong {
            color: var(--accent-secondary);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 3rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-primary {
            background: var(--gradient-main);
            color: white;
            box-shadow: 0 4px 6px rgba(56, 189, 248, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 12px rgba(56, 189, 248, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.75rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .question-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Preparação Exame SMUL1</h1>
            <p>100 Questões de Preparação (DDD, Scrum, Requisitos, Flask)</p>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-value" id="total-answered">0</div>
                <div class="stat-label">Respondidas</div>
            </div>
            <div class="stat correct">
                <div class="stat-value" id="total-correct">0</div>
                <div class="stat-label">Correctas</div>
            </div>
            <div class="stat wrong">
                <div class="stat-value" id="total-wrong">0</div>
                <div class="stat-label">Erradas</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="percentage">0%</div>
                <div class="stat-label">Acerto</div>
            </div>
            <div class="stat reset-btn" onclick="resetQuiz()" title="Reiniciar Quiz">
                <div class="stat-value">↻</div>
                <div class="stat-label">Reiniciar</div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
        </div>

        <div class="toggle-container">
            <label class="toggle">
                <input type="checkbox" id="hide-answered">
                <span>Esconder respondidas</span>
            </label>
        </div>

        <div id="questions-container"></div>

        <div class="btn-group">
            <button class="btn btn-secondary" onclick="resetQuiz()">↻ Reiniciar Tudo</button>
            <button class="btn btn-primary" onclick="scrollToUnanswered()">↓ Próxima Questão</button>
        </div>
    </div>

    <!-- Prism JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <script>
        // ========================================================================
        // DADOS DAS QUESTÕES
        // ========================================================================
        const questions = [
    {
        "category": "DDD",
        "question": "O que significa DDD?",
        "options": [
            "Domain-Driven Design",
            "Data-Driven Development",
            "Design-Driven Data",
            "Domain-Data Definition"
        ],
        "correct": 0,
        "explanation": "DDD significa Domain-Driven Design, uma abordagem de desenvolvimento focada no núcleo do negócio."
    },
    {
        "category": "DDD",
        "question": "Qual é o principal objetivo do DDD?",
        "options": [
            "Alinhar o código com a realidade do negócio",
            "Criar bases de dados mais rápidas",
            "Usar microserviços obrigatoriamente",
            "Reduzir o custo de servidores"
        ],
        "correct": 0,
        "explanation": "O DDD foca-se na complexidade do domínio e em garantir que o software resolve problemas reais do negócio."
    },
    {
        "category": "DDD",
        "question": "O que caracteriza uma Entidade (Entity) em DDD?",
        "options": [
            "Tem identidade única e contínua",
            "É definida apenas pelos seus atributos",
            "É imutável",
            "Não pode ter métodos"
        ],
        "correct": 0,
        "explanation": "Entidades são definidas pela sua identidade (ID), que persiste mesmo que os seus atributos mudem."
    },
    {
        "category": "DDD",
        "question": "O que caracteriza um Objeto de Valor (Value Object)?",
        "options": [
            "É definido pelos seus atributos e não tem identidade",
            "Tem um ID único na base de dados",
            "Pode ser alterado livremente",
            "É a raiz do agregado"
        ],
        "correct": 0,
        "explanation": "Value Objects não têm identidade própria; são caracterizados apenas pelos seus valores (ex: uma cor, um valor monetário)."
    },
    {
        "category": "DDD",
        "question": "Qual destas opções descreve melhor um Agregado (Aggregate)?",
        "options": [
            "Um conjunto de objetos tratados como uma unidade de consistência",
            "Uma tabela na base de dados",
            "Uma coleção de serviços",
            "Um módulo do Python"
        ],
        "correct": 0,
        "explanation": "Um Agregado é um cluster de objetos de domínio que podem ser tratados como uma única unidade. Qualquer alteração deve manter a consistência de todo o agregado."
    },
    {
        "category": "DDD",
        "question": "Quem é a Aggregate Root?",
        "options": [
            "A única entidade do agregado que pode ser referenciada externamente",
            "A tabela principal da base de dados",
            "O utilizador administrador",
            "O primeiro objeto criado no sistema"
        ],
        "correct": 0,
        "explanation": "A Root é a porta de entrada do Agregado. Objetos de fora só podem referenciar a Root, nunca os objetos internos."
    },
    {
        "category": "DDD",
        "question": "Como deve ser feita a referência entre Agregados diferentes?",
        "options": [
            "Através do ID da Root",
            "Através de apontadores de memória",
            "Incluindo o objeto todo",
            "Não deve haver referências"
        ],
        "correct": 0,
        "explanation": "Para evitar acoplamento e problemas de performance, agregados devem referenciar outros agregados apenas pelo seu ID."
    },
    {
        "category": "DDD",
        "question": "Exemplo: Uma 'Morada' num sistema de entregas geralmente é modelada como:",
        "options": [
            "Value Object",
            "Entity",
            "Aggregate Root",
            "Service"
        ],
        "correct": 0,
        "explanation": "Uma morada é definida pelos seus valores (Rua, Código Postal). Se mudas a rua, é uma nova morada, logo é um Value Object."
    },
    {
        "category": "DDD",
        "question": "Exemplo: Um 'Cliente' num sistema de vendas é geralmente:",
        "options": [
            "Entity (e provavelmente Aggregate Root)",
            "Value Object",
            "Service",
            "Repository"
        ],
        "correct": 0,
        "explanation": "Um cliente tem identidade e ciclo de vida próprio, sendo normalmente uma Entidade e Raiz do seu próprio agregado."
    },
    {
        "category": "DDD",
        "question": "O que é a 'Linguagem Ubíqua' (Ubiquitous Language)?",
        "options": [
            "Linguagem comum entre developers e especialistas de domínio",
            "A linguagem de programação usada (ex: Python)",
            "O inglês, obrigatoriamente",
            "SQL"
        ],
        "correct": 0,
        "explanation": "É a linguagem partilhada e rigorosa usada por toda a equipa (técnica e de negócio) para descrever o modelo."
    },
    {
        "category": "DDD",
        "question": "Se um Objeto de Valor (Value Object) precisar de ser alterado, o que se deve fazer?",
        "options": [
            "Criar uma nova instância com os novos valores",
            "Alterar os atributos da instância existente",
            "Apagar o agregado",
            "Converter em Entidade"
        ],
        "correct": 0,
        "explanation": "Value Objects devem ser imutáveis. Para 'alterar', substitui-se o objeto antigo por um novo."
    },
    {
        "category": "DDD",
        "question": "O que acontece aos objetos dentro de um Agregado se a Root for apagada?",
        "options": [
            "Devem ser apagados também (Cascading Delete)",
            "Ficam órfãos",
            "São movidos para outro agregado",
            "Nada"
        ],
        "correct": 0,
        "explanation": "O Agregado é uma unidade de consistência e ciclo de vida. Sem a Root, os objetos internos não fazem sentido e devem ser removidos."
    },
    {
        "category": "DDD",
        "question": "Qual destas é uma regra de ouro dos Agregados?",
        "options": [
            "Uma transação deve alterar apenas um agregado de cada vez",
            "Agregados devem ser o maior possível",
            "Agregados podem referenciar objetos internos de outros agregados",
            "Roots não têm ID"
        ],
        "correct": 0,
        "explanation": "Idealmente, uma transação altera um só agregado para garantir escalabilidade e consistência simples."
    },
    {
        "category": "DDD",
        "question": "Onde deve ficar a lógica de validação de um Agregado?",
        "options": [
            "Dentro do próprio Agregado (na Root ou Entidades)",
            "No Controller",
            "No Frontend",
            "Na Base de Dados"
        ],
        "correct": 0,
        "explanation": "O modelo de domínio deve ser 'Rico' e conter as suas próprias regras de negócio e validações invariantes."
    },
    {
        "category": "DDD",
        "question": "O que é um Repositório (Repository) no DDD?",
        "options": [
            "Camada que abstrai a persistência (Base de Dados)",
            "Onde guardamos o código (GitHub)",
            "Um tipo de Entidade",
            "Um serviço de email"
        ],
        "correct": 0,
        "explanation": "Os repositórios servem para recuperar e guardar Agregados, escondendo os detalhes técnicos da base de dados."
    },
    {
        "category": "DDD",
        "question": "Um Repositório deve ser criado para:",
        "options": [
            "Apenas Aggregate Roots",
            "Todas as Entidades",
            "Todos os Value Objects",
            "Tabelas auxiliares"
        ],
        "correct": 0,
        "explanation": "Apenas as Aggregate Roots têm repositórios globais. Objetos internos são acedidos via Root."
    },
    {
        "category": "DDD",
        "question": "O que é um 'Bounded Context'?",
        "options": [
            "Uma fronteira lógica onde um modelo de domínio específico é válido",
            "Uma variável limitada",
            "Um limite de memória",
            "Uma restrição da base de dados"
        ],
        "correct": 0,
        "explanation": "Bounded Context define os limites onde um determinado modelo e Linguagem Ubíqua se aplicam (ex: Contexto de Vendas vs Contexto de Suporte)."
    },
    {
        "category": "DDD",
        "question": "No contexto de uma Loja Online, 'Produto' no catálogo e 'Produto' no inventário são:",
        "options": [
            "Possivelmente modelos diferentes em Bounded Contexts diferentes",
            "Exatamente a mesma classe",
            "Value Objects",
            "Sempre a mesma entidade"
        ],
        "correct": 0,
        "explanation": "Em contextos diferentes (Vendas vs Logística), o conceito de 'Produto' pode ter atributos e comportamentos muito diferentes."
    },
    {
        "category": "DDD",
        "question": "Se dois objetos têm atributos iguais mas devem ser distinguidos, são:",
        "options": [
            "Entidades",
            "Value Objects",
            "Clones",
            "Singletons"
        ],
        "correct": 0,
        "explanation": "Se a distinção é necessária apesar dos atributos iguais, é necessária uma identidade -> Entidade."
    },
    {
        "category": "DDD",
        "question": "Um 'Email' (string de endereço) é tipicamente um:",
        "options": [
            "Value Object",
            "Entity",
            "Service",
            "Module"
        ],
        "correct": 0,
        "explanation": "O endereço de email em si é um valor. Se duas pessoas têm o email 'a@b.com', é o mesmo endereço value object."
    },
    {
        "category": "DDD",
        "question": "Serviços de Domínio (Domain Services) usam-se quando:",
        "options": [
            "Uma operação não pertence naturalmente a uma Entidade ou Value Object",
            "Queremos aceder à base de dados",
            "Precisamos de uma API REST",
            "Sempre que há lógica"
        ],
        "correct": 0,
        "explanation": "Domain Services encapsulam lógica de negócio que envolve múltiplas entidades ou não cabe bem numa só."
    },
    {
        "category": "DDD",
        "question": "A imutabilidade dos Value Objects facilita:",
        "options": [
            "A partilha segura e a ausência de efeitos colaterais",
            "A escrita na base de dados",
            "A criação de IDs",
            "O routing do Flask"
        ],
        "correct": 0,
        "explanation": "Sendo imutáveis, podem ser passados e partilhados sem medo que alguém os altere inesperadamente."
    },
    {
        "category": "DDD",
        "question": "Um identificador (ID) deve ser:",
        "options": [
            "Único dentro do seu tipo/sistema",
            "Sempre um número inteiro sequencial",
            "Aleatório sempre",
            "Opcional"
        ],
        "correct": 0,
        "explanation": "A unicidade é a característica essencial da identidade."
    },
    {
        "category": "DDD",
        "question": "O DDD defende o foco em:",
        "options": [
            "Domínio do problema e Lógica de Negócio",
            "Interface do Utilizador",
            "Infraestrutura Tecnológica",
            "Performance de Baixo Nível"
        ],
        "correct": 0,
        "explanation": "O 'Coração' do software é o negócio."
    },
    {
        "category": "DDD",
        "question": "Qual a relação entre DDD e Bases de Dados?",
        "options": [
            "O modelo de domínio não deve ser ditado pela base de dados",
            "A base de dados dita o modelo",
            "DDD obriga a usar NoSQL",
            "DDD não usa bases de dados"
        ],
        "correct": 0,
        "explanation": "Persistence Ignorance: O domínio deve ser desenhado para resolver o problema de negócio, a persistência é um detalhe de implementação."
    },
    {
        "category": "Scrum",
        "question": "O SCRUM é uma metodologia:",
        "options": [
            "Ágil",
            "Waterfall",
            "Cascata",
            "Rígida"
        ],
        "correct": 0,
        "explanation": "Scrum é a framework ágil mais popular."
    },
    {
        "category": "Scrum",
        "question": "Qual NÃO é um papel (Role) no Scrum?",
        "options": [
            "Project Manager",
            "Product Owner",
            "Scrum Master",
            "Development Team"
        ],
        "correct": 0,
        "explanation": "No Scrum 'puro', não existe a figura do Project Manager tradicional. As responsabilidades são divididas."
    },
    {
        "category": "Scrum",
        "question": "Quem é responsável por gerir o Product Backlog?",
        "options": [
            "Product Owner",
            "Scrum Master",
            "Team",
            "Cliente"
        ],
        "correct": 0,
        "explanation": "O PO é o dono do produto e prioriza o trabalho."
    },
    {
        "category": "Scrum",
        "question": "Quem é responsável por decidir COMO fazer o trabalho?",
        "options": [
            "Development Team",
            "Product Owner",
            "Scrum Master",
            "CEO"
        ],
        "correct": 0,
        "explanation": "A equipa é auto-organizada e decide os aspetos técnicos."
    },
    {
        "category": "Scrum",
        "question": "Qual é a duração típica de um Sprint?",
        "options": [
            "1 a 4 semanas",
            "3 a 6 meses",
            "1 dia",
            "Variável conforme o trabalho"
        ],
        "correct": 0,
        "explanation": "Sprints são time-boxed (duração fixa), tipicamente 2 semanas, max 4."
    },
    {
        "category": "Scrum",
        "question": "O que acontece na Sprint Planning?",
        "options": [
            "A equipa define o que vai fazer no Sprint",
            "A equipa mostra o trabalho feito",
            "A equipa discute problemas pessoais",
            "O PO distribui tarefas"
        ],
        "correct": 0,
        "explanation": "Planeamento colaborativo do trabalho do Sprint."
    },
    {
        "category": "Scrum",
        "question": "Qual o objetivo da Daily Scrum?",
        "options": [
            "Sincronizar a equipa e planear as próximas 24h",
            "Resolver problemas técnicos complexos nas 15 min",
            "O PO dar ordens",
            "Fazer relatórios de progresso para a gestão"
        ],
        "correct": 0,
        "explanation": "Sincronização rápida. Problemas complexos discutem-se depois."
    },
    {
        "category": "Scrum",
        "question": "Quando ocorre a Sprint Review?",
        "options": [
            "No final do Sprint",
            "No início do Sprint",
            "A meio do Sprint",
            "Todos os dias"
        ],
        "correct": 0,
        "explanation": "Para inspecionar o incremento e adaptar o Product Backlog."
    },
    {
        "category": "Scrum",
        "question": "Qual a diferença entre Review e Retrospective?",
        "options": [
            "Review foca no Produto, Retrospective foca no Processo",
            "Review é interna, Retrospective é com o cliente",
            "São a mesma coisa",
            "Retrospective é opcional"
        ],
        "correct": 0,
        "explanation": "A Review é sobre 'O que fizemos'. A Retrospective é sobre 'Como trabalhámos'."
    },
    {
        "category": "Scrum",
        "question": "O que é um Incremento?",
        "options": [
            "A soma de todos os itens do Backlog completados no Sprint + anteriores",
            "O aumento de salário",
            "A lista de requisitos",
            "O plano de testes"
        ],
        "correct": 0,
        "explanation": "É o resultado utilizável e 'Done' do Sprint."
    },
    {
        "category": "Scrum",
        "question": "O que é o Definition of Done (DoD)?",
        "options": [
            "Uma lista de critérios para considerar um item completo",
            "A data de entrega",
            "O documento de requisitos",
            "A aprovação do chefe"
        ],
        "correct": 0,
        "explanation": "Garante qualidade e transparência sobre o estado do trabalho."
    },
    {
        "category": "Scrum",
        "question": "O Scrum Master é:",
        "options": [
            "Um líder servidor (Servant-Leader)",
            "O chefe da equipa",
            "O secretário do projeto",
            "O responsável pelos commits"
        ],
        "correct": 0,
        "explanation": "Ajuda a equipa e a organização a usar o Scrum, removendo impedimentos."
    },
    {
        "category": "Scrum",
        "question": "Se o Sprint não acabar e sobrarem tarefas, o que acontece?",
        "options": [
            "O Sprint termina na data marcada e o que não foi feito volta ao Backlog",
            "O Sprint é prolongado",
            "A equipa trabalha no fim de semana",
            "O projeto é cancelado"
        ],
        "correct": 0,
        "explanation": "Sprints são time-boxed. Nunca se estendem. Aprende-se com isso para planear menos no próximo."
    },
    {
        "category": "Scrum",
        "question": "O Waterfall é ideal quando:",
        "options": [
            "Os requisitos são claros e fixos desde o início",
            "O cliente não sabe o que quer",
            "O mercado muda rápido",
            "A equipa é pequena"
        ],
        "correct": 0,
        "explanation": "Cascata funciona bem para projetos previsíveis e lineares."
    },
    {
        "category": "Scrum",
        "question": "O Manifesto Ágil valoriza mais 'Software a funcionar' do que:",
        "options": [
            "Documentação abrangente",
            "Interação com indivíduos",
            "Colaboração com o cliente",
            "Mudança"
        ],
        "correct": 0,
        "explanation": "Embora valorize a documentação, o software funcional é a medida primária de progresso."
    },
    {
        "category": "Scrum",
        "question": "O que é o Sprint Backlog?",
        "options": [
            "Itens selecionados do Product Backlog para o Sprint + plano de entrega",
            "Todo o trabalho do projeto",
            "O histórico de bugs",
            "As notas da reunião"
        ],
        "correct": 0,
        "explanation": "É o plano da equipa para o Sprint atual."
    },
    {
        "category": "Scrum",
        "question": "Quem pode cancelar um Sprint?",
        "options": [
            "Apenas o Product Owner",
            "O Scrum Master",
            "A Equipa",
            "O Cliente"
        ],
        "correct": 0,
        "explanation": "O PO tem a autoridade para cancelar se o objetivo do Sprint se tornar obsoleto."
    },
    {
        "category": "Scrum",
        "question": "O que é um 'Burn-down Chart'?",
        "options": [
            "Gráfico que mostra trabalho restante vs tempo",
            "Gráfico de custos",
            "Gráfico de bugs",
            "Layout do escritório"
        ],
        "correct": 0,
        "explanation": "Ferramenta visual para acompanhar o progresso do Sprint ou Projeto."
    },
    {
        "category": "Scrum",
        "question": "A equipa de desenvolvimento deve ser:",
        "options": [
            "Multifuncional (Cross-functional)",
            "Especializada apenas numa coisa",
            "Grande (>15 pessoas)",
            "Gerida pelo Scrum Master"
        ],
        "correct": 0,
        "explanation": "Deve ter todas as competências necessárias para entregar o incremento."
    },
    {
        "category": "Scrum",
        "question": "O Scrum garante sucesso automático do projeto?",
        "options": [
            "Não, é uma framework que expõe problemas",
            "Sim, sempre",
            "Sim, se usarmos Jira",
            "Depende do orçamento"
        ],
        "correct": 0,
        "explanation": "Scrum torna os problemas visíveis para que possam ser resolvidos, não os resolve por magia."
    },
    {
        "category": "Scrum",
        "question": "User Stories são estimadas frequentemente usando:",
        "options": [
            "Story Points",
            "Horas exatas",
            "Linhas de código",
            "Número de ficheiros"
        ],
        "correct": 0,
        "explanation": "Story Points medem esforço relativo/complexidade, não tempo absoluto."
    },
    {
        "category": "Scrum",
        "question": "Planning Poker é uma técnica para:",
        "options": [
            "Estimativa conjunta",
            "Jogar no intervalo",
            "Decidir quem paga o almoço",
            "Priorizar bugs"
        ],
        "correct": 0,
        "explanation": "Técnica de consenso para estimar o esforço das User Stories."
    },
    {
        "category": "Scrum",
        "question": "O Backlog deve ser DEEP. O 'E' significa:",
        "options": [
            "Estimated",
            "Easy",
            "Expensive",
            "External"
        ],
        "correct": 0,
        "explanation": "Detailed appropriately, Estimated, Emergent, Prioritized."
    },
    {
        "category": "Scrum",
        "question": "No Scrum, as alterações durante o Sprint:",
        "options": [
            "Devem ser evitadas para não comprometer o foco",
            "São encorajadas a qualquer momento",
            "São proibidas por lei",
            "Dependem do humor do chefe"
        ],
        "correct": 0,
        "explanation": "O Sprint deve ter estabilidade. Mudanças vão para o próximo."
    },
    {
        "category": "Scrum",
        "question": "A 'Velocity' da equipa é:",
        "options": [
            "A média de Story Points entregues por Sprint",
            "A velocidade de escrita de código",
            "O número de horas extra",
            "A rapidez do servidor"
        ],
        "correct": 0,
        "explanation": "Ajuda a prever quanto trabalho a equipa consegue fazer em sprints futuros."
    },
    {
        "category": "Requisitos",
        "question": "Um Requisito Funcional descreve:",
        "options": [
            "O que o sistema faz",
            "Como o sistema faz",
            "A velocidade do sistema",
            "A cor do sistema"
        ],
        "correct": 0,
        "explanation": "Funcionalidades, comportamentos, serviços."
    },
    {
        "category": "Requisitos",
        "question": "Um Requisito Não Funcional descreve:",
        "options": [
            "Atributos de qualidade e restrições",
            "Novas funcionalidades",
            "As funções de login",
            "Os casos de uso"
        ],
        "correct": 0,
        "explanation": "Performance, Segurança, Usabilidade, etc."
    },
    {
        "category": "Requisitos",
        "question": "No acrónimo FURPS+, o 'P' significa:",
        "options": [
            "Performance",
            "Process",
            "Planning",
            "People"
        ],
        "correct": 0,
        "explanation": "Desempenho (tempo de resposta, throughput, recursos)."
    },
    {
        "category": "Requisitos",
        "question": "No acrónimo FURPS+, o 'R' significa:",
        "options": [
            "Reliability (Confiabilidade)",
            "Requirements",
            "Risk",
            "Realism"
        ],
        "correct": 0,
        "explanation": "Disponibilidade, MTBF (Mean Time Between Failures), recuperação."
    },
    {
        "category": "Requisitos",
        "question": "Qual destes é um Requisito Não Funcional?",
        "options": [
            "O sistema deve responder em menos de 1 segundo",
            "O sistema deve permitir login",
            "O sistema deve calcular juros",
            "O sistema deve imprimir relatório"
        ],
        "correct": 0,
        "explanation": "É uma restrição de performance."
    },
    {
        "category": "Requisitos",
        "question": "Uma User Story segue tipicamente o formato:",
        "options": [
            "Como [ator], quero [ação] para [benefício]",
            "O sistema deve [ação]",
            "Se [condição] então [resultado]",
            "Eu quero [coisa]"
        ],
        "correct": 0,
        "explanation": "Foca no valor para o utilizador."
    },
    {
        "category": "Requisitos",
        "question": "Num Diagrama de Casos de Uso, um Ator representa:",
        "options": [
            "Um papel desempenhado por um utilizador ou sistema externo",
            "Uma pessoa específica",
            "O administrador",
            "Um botão no ecrã"
        ],
        "correct": 0,
        "explanation": "Atores são papéis (Ex: Cliente, Gestor, API Externa)."
    },
    {
        "category": "Requisitos",
        "question": "A relação 'Include' num Caso de Uso significa:",
        "options": [
            "O caso de uso base obrigatoriamente usa o incluído",
            "O caso de uso incluído é opcional",
            "O caso de uso base é filho do incluído",
            "Uma herança"
        ],
        "correct": 0,
        "explanation": "Reutilização de comportamento comum e obrigatório."
    },
    {
        "category": "Requisitos",
        "question": "A relação 'Extend' num Caso de Uso significa:",
        "options": [
            "Comportamento opcional ou excecional sob certas condições",
            "Comportamento obrigatório",
            "Cópia do caso de uso",
            "Erro de sistema"
        ],
        "correct": 0,
        "explanation": "O caso base pode funcionar sem a extensão, mas a extensão adiciona passos extras em certos cenários."
    },
    {
        "category": "Requisitos",
        "question": "O 'Levantamento de Requisitos' é:",
        "options": [
            "O processo de descobrir o que os stakeholders precisam",
            "Escrever código",
            "Testar o software",
            "Instalar o servidor"
        ],
        "correct": 0,
        "explanation": "Entrevistas, workshops, observação para entender o problema."
    },
    {
        "category": "Requisitos",
        "question": "Qual destes é um requisito de Usabilidade (FURPS)?",
        "options": [
            "O sistema deve ser intuitivo para utilizadores sem formação",
            "O sistema deve encriptar passwords",
            "O sistema deve aguentar 1000 users",
            "O sistema deve ter backup"
        ],
        "correct": 0,
        "explanation": "Facilidade de uso e aprendizagem."
    },
    {
        "category": "Requisitos",
        "question": "O 'Critério de Aceitação' numa User Story serve para:",
        "options": [
            "Definir quando a história está completa e correta",
            "Dizer quem vai fazer",
            "Definir o prazo",
            "Contar piadas"
        ],
        "correct": 0,
        "explanation": "Testes ou condições que têm de ser verdadeiros para a Story ser aceite."
    },
    {
        "category": "Requisitos",
        "question": "A WBS (Work Breakdown Structure) serve para:",
        "options": [
            "Decompor o projeto em partes menores e geríveis",
            "Fazer diagramas de classes",
            "Programar em Java",
            "Gerir versões Git"
        ],
        "correct": 0,
        "explanation": "Estrutura Analítica do Projeto, hierárquica."
    },
    {
        "category": "Requisitos",
        "question": "Requisitos de 'Supportability' incluem:",
        "options": [
            "Facilidade de manutenção e instalação",
            "Rapidez",
            "Cores do ecrã",
            "Preço"
        ],
        "correct": 0,
        "explanation": "Manutenibilidade, escalabilidade, compatibilidade."
    },
    {
        "category": "Requisitos",
        "question": "O Diagrama de Gantt é usado para:",
        "options": [
            "Calendarização e gestão de dependências temporais",
            "Desenhar base de dados",
            "Modelar classes",
            "Escrever testes"
        ],
        "correct": 0,
        "explanation": "Visualizar o cronograma do projeto."
    },
    {
        "category": "Requisitos",
        "question": "Um 'Stakeholder' é:",
        "options": [
            "Qualquer pessoa/entidade afetada pelo projeto",
            "Apenas quem paga",
            "Apenas o programador",
            "Apenas o chefe"
        ],
        "correct": 0,
        "explanation": "Interessados no projeto (Clientes, Utilizadores, Equipa, Reguladores)."
    },
    {
        "category": "Requisitos",
        "question": "'O sistema deve ser desenvolvido em Python'. Isto é um requisito de:",
        "options": [
            "Implementação (Restrição Técnica)",
            "Funcional",
            "Usabilidade",
            "Desempenho"
        ],
        "correct": 0,
        "explanation": "Muitas vezes cai no '+' do FURPS+ (Design/Implementation Constraints)."
    },
    {
        "category": "Requisitos",
        "question": "Brainstorming é uma técnica de:",
        "options": [
            "Elicitação (Levantamento) de Requisitos",
            "Programação",
            "Teste",
            "Deploy"
        ],
        "correct": 0,
        "explanation": "Gerar ideias em grupo."
    },
    {
        "category": "Requisitos",
        "question": "Um Caso de Uso descreve o sistema como:",
        "options": [
            "Uma caixa preta (Black Box)",
            "Uma caixa branca (código visível)",
            "Um fluxograma detalhado",
            "Uma base de dados"
        ],
        "correct": 0,
        "explanation": "Foca nas interações externas, não na implementação interna."
    },
    {
        "category": "Requisitos",
        "question": "MoSCoW é uma técnica para:",
        "options": [
            "Priorização de requisitos",
            "Programação na Rússia",
            "Gestão de memória",
            "Design gráfico"
        ],
        "correct": 0,
        "explanation": "Must have, Should have, Could have, Won't have."
    },
    {
        "category": "Requisitos",
        "question": "Prototipagem ajuda a:",
        "options": [
            "Validar requisitos e interface com o utilizador",
            "Gerar o código final automaticamente",
            "Substituir a base de dados",
            "Evitar testes"
        ],
        "correct": 0,
        "explanation": "Ter feedback visual cedo."
    },
    {
        "category": "Requisitos",
        "question": "A rastreabilidade dos requisitos permite:",
        "options": [
            "Saber a origem e onde é implementado cada requisito",
            "Saber quem escreveu o código",
            "Saber a hora do commit",
            "Nada"
        ],
        "correct": 0,
        "explanation": "Ligar Requisito <-> Design <-> Código <-> Teste."
    },
    {
        "category": "Requisitos",
        "question": "Qual a diferença entre Cliente e Utilizador?",
        "options": [
            "O Cliente compra/decide, o Utilizador usa",
            "São sempre a mesma pessoa",
            "O Utilizador manda no Cliente",
            "Não há diferença"
        ],
        "correct": 0,
        "explanation": "Nem sempre quem paga é quem usa o sistema."
    },
    {
        "category": "Requisitos",
        "question": "Um diagrama de Casos de Uso é um diagrama:",
        "options": [
            "Comportamental UML",
            "Estrutural UML",
            "Entidade-Relacionamento",
            "De fluxo de dados"
        ],
        "correct": 0,
        "explanation": "Mostra o comportamento do sistema sob o ponto de vista dos atores."
    },
    {
        "category": "Requisitos",
        "question": "Validar requisitos significa:",
        "options": [
            "Confirmar que estamos a construir o produto certo",
            "Verificar se o código compila",
            "Instalar o Windows",
            "Formatar o PC"
        ],
        "correct": 0,
        "explanation": "Validation vs Verification."
    },
    {
        "category": "Flask",
        "question": "O Flask segue o padrão arquitetural:",
        "options": [
            "MVC (ou MVT)",
            "Singleton",
            "Observer",
            "Microservice puro sem padrão"
        ],
        "correct": 0,
        "explanation": "Model-View-Controller (adaptado)."
    },
    {
        "category": "Flask",
        "question": "Qual o decorador para definir uma rota em Flask?",
        "options": [
            "@app.route('/')",
            "@app.path('/')",
            "@app.url('/')",
            "def route():"
        ],
        "correct": 0,
        "explanation": "Regista a função para responder a um URL."
    },
    {
        "category": "Flask",
        "question": "O que faz o `render_template`?",
        "options": [
            "Gera HTML a partir de um template Jinja2",
            "Envia um ficheiro estático",
            "Redireciona o utilizador",
            "Erros de base de dados"
        ],
        "correct": 0,
        "explanation": "Combina o template HTML com os dados Python."
    },
    {
        "category": "Flask",
        "question": "O SQLAlchemy é:",
        "options": [
            "Um ORM (Object Relational Mapper)",
            "Uma base de dados",
            "Um servidor web",
            "Um navegador"
        ],
        "correct": 0,
        "explanation": "Biblioteca para interagir com SQL usando objetos Python."
    },
    {
        "category": "Flask",
        "question": "Para passar dados de um form HTML para o Flask, usamos:",
        "options": [
            "request.form",
            "request.data",
            "request.args",
            "request.html"
        ],
        "correct": 0,
        "explanation": "Dados de POST form-data vêm em request.form."
    },
    {
        "category": "Flask",
        "question": "O comando `git init` serve para:",
        "options": [
            "Iniciar um novo repositório Git local",
            "Iniciar o download",
            "Iniciar o PC",
            "Apagar tudo"
        ],
        "correct": 0,
        "explanation": "Cria a pasta .git."
    },
    {
        "category": "Flask",
        "question": "Para guardar o estado atual dos ficheiros no histórico Git, usamos:",
        "options": [
            "git commit",
            "git save",
            "git store",
            "git record"
        ],
        "correct": 0,
        "explanation": "Cria um snapshot (commit) na timeline."
    },
    {
        "category": "Flask",
        "question": "O Jinja2 permite usar lógica nos templates HTML. O símbolo `{% %}` é para:",
        "options": [
            "Estruturas de controlo (if, for)",
            "Imprimir variáveis",
            "Comentários",
            "CSS"
        ],
        "correct": 0,
        "explanation": "{{ }} é para output, {% %} é para lógica."
    },
    {
        "category": "Flask",
        "question": "Método HTTP para enviar dados sensíveis (login) ou criar recursos:",
        "options": [
            "POST",
            "GET",
            "HEAD",
            "OPTION"
        ],
        "correct": 0,
        "explanation": "POST envia dados no corpo do pedido, mais seguro que GET (URL)."
    },
    {
        "category": "Flask",
        "question": "Em SQLAlchemy, uma classe que herda de `db.Model` representa:",
        "options": [
            "Uma tabela na base de dados",
            "Uma linha",
            "Uma coluna",
            "Uma query"
        ],
        "correct": 0,
        "explanation": "O modelo define a estrutura da tabela."
    },
    {
        "category": "Flask",
        "question": "O que é uma 'Migration'?",
        "options": [
            "Uma alteração controlada ao esquema da base de dados",
            "Mudar de servidor",
            "Mudar de linguagem",
            "Copiar ficheiros"
        ],
        "correct": 0,
        "explanation": "Versionamento da estrutura da BD (ex: Alembic)."
    },
    {
        "category": "Flask",
        "question": "`git pull` é a combinação de:",
        "options": [
            "git fetch + git merge",
            "git fetch + git rebase",
            "git download + git update",
            "git clone + git init"
        ],
        "correct": 0,
        "explanation": "Traz as alterações e aplica-as no branch atual."
    },
    {
        "category": "Flask",
        "question": "O ficheiro `.gitignore` serve para:",
        "options": [
            "Listar ficheiros que o Git deve ignorar",
            "Guardar passwords",
            "Configurar o servidor",
            "Ignorar erros"
        ],
        "correct": 0,
        "explanation": "Evita commitar lixo, ficheiros compilados, .env, etc."
    },
    {
        "category": "Flask",
        "question": "Para criar um ambiente virtual em Python:",
        "options": [
            "python -m venv venv",
            "python create env",
            "virtualenv start",
            "pip install env"
        ],
        "correct": 0,
        "explanation": "Comando padrão para isolar dependências."
    },
    {
        "category": "Flask",
        "question": "O ficheiro `requirements.txt` serve para:",
        "options": [
            "Listar as dependências do projeto",
            "Guardar requisitos funcionais",
            "Configurar o Git",
            "Documentar o código"
        ],
        "correct": 0,
        "explanation": "Permite instalar tudo com pip install -r requirements.txt."
    },
    {
        "category": "Flask",
        "question": "Em MVC, a 'View' (no contexto geral, não Flask específico) é responsável por:",
        "options": [
            "Apresentar os dados ao utilizador",
            "Aceder à BD",
            "Processar a lógica",
            "Enviar email"
        ],
        "correct": 0,
        "explanation": "Renderização da interface."
    },
    {
        "category": "Flask",
        "question": "Qual comando instala bibliotecas Python?",
        "options": [
            "pip install",
            "python get",
            "npm install",
            "git install"
        ],
        "correct": 0,
        "explanation": "Pip Installs Packages."
    },
    {
        "category": "Flask",
        "question": "O que é o 'Github'?",
        "options": [
            "Uma plataforma de alojamento de código Git",
            "O mesmo que Git",
            "Uma linguagem",
            "Um sistema operativo"
        ],
        "correct": 0,
        "explanation": "Git é a ferramenta, GitHub é o serviço."
    },
    {
        "category": "Flask",
        "question": "Para aceder a parâmetros do URL (ex: /search?q=gato) usamos:",
        "options": [
            "request.args",
            "request.form",
            "request.json",
            "request.path"
        ],
        "correct": 0,
        "explanation": "Query strings estão em args."
    },
    {
        "category": "Flask",
        "question": "session.commit() em SQLAlchemy serve para:",
        "options": [
            "Confirmar e gravar as alterações na BD",
            "Cancelar alterações",
            "Iniciar transação",
            "Apagar tudo"
        ],
        "correct": 0,
        "explanation": "Torna persistente a transação atual."
    },
    {
        "category": "Flask",
        "question": "Flask é considerado 'micro' porque:",
        "options": [
            "Não traz ORM nem validação por defeito, é modular",
            "É lento",
            "Só serve para sites pequenos",
            "Foi feito por uma pessoa pequena"
        ],
        "correct": 0,
        "explanation": "Core simples, extensível via plugins."
    },
    {
        "category": "Flask",
        "question": "Para definir uma chave primária em SQLAlchemy:",
        "options": [
            "primary_key=True",
            "id=True",
            "key=Primary",
            "unique=True"
        ],
        "correct": 0,
        "explanation": "Atributo da coluna."
    },
    {
        "category": "Flask",
        "question": "Um 'branch' no Git permite:",
        "options": [
            "Desenvolver funcionalidades isoladamente",
            "Partir o código",
            "Criar um novo repositório",
            "Apagar histórico"
        ],
        "correct": 0,
        "explanation": "Ramos paralelos de desenvolvimento."
    },
    {
        "category": "Flask",
        "question": "O erro 404 significa:",
        "options": [
            "Not Found",
            "Server Error",
            "Unauthorized",
            "Bad Request"
        ],
        "correct": 0,
        "explanation": "Recurso não encontrado."
    },
    {
        "category": "Flask",
        "question": "O erro 500 significa:",
        "options": [
            "Internal Server Error",
            "NotFound",
            "OK",
            "Redirect"
        ],
        "correct": 0,
        "explanation": "Erro no servidor (código crashou)."
    }
];

        // ESTADO APLICAÇÃO
        // ========================================================================
        let answers = {};

        // ========================================================================
        // FUNÇÕES
        // ========================================================================

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            const hideAnswered = document.getElementById('hide-answered').checked;

            let filtered = questions;
            if (hideAnswered) {
                filtered = filtered.filter(q => answers[q.id] === undefined);
            }

            container.innerHTML = filtered.length
                ? filtered.map(q => createQuestionCard(q)).join('')
                : '<p style="text-align:center; padding: 2rem; color: var(--text-secondary)">Todas as questões apresentadas foram respondidas.</p>';

            // Re-run Prism highlighting on new elements
            Prism.highlightAll();
        }

        function createQuestionCard(q) {
            const answer = answers[q.id];
            const isAnswered = answer !== undefined;
            const isCorrect = answer === q.correct;

            let cardClass = 'question-card';
            if (isAnswered) {
                cardClass += ' answered ' + (isCorrect ? 'correct-answer' : 'wrong-answer');
            }

            return `
                <div class="${cardClass}" id="question-${q.id}">
                    <div class="question-header">
                        <span class="question-number">Questão ${q.id}</span>
                        <span class="question-category">${q.category}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, i) => createOption(q.id, opt, i, q.correct, answer)).join('')}
                    </div>
                    ${isAnswered ? createFeedback(isCorrect, q.options[q.correct], q.explanation) : ''}
                </div>
            `;
        }

        function createOption(qId, text, index, correct, answer) {
            const isAnswered = answer !== undefined;
            const isSelected = answer === index;
            const isCorrectOption = correct === index;

            let optClass = 'option';
            if (isAnswered) {
                optClass += ' disabled';
                if (isCorrectOption) optClass += ' correct';
                else if (isSelected) optClass += ' wrong';
            }

            // Converter código nas opções para usar code tags do Prism lightweight se necessário
            // Mas as opções já vêm com HTML <code> básico. 
            // Vamos assumir que o CSS trata do básico ou o user quer highlight real lá também?
            // Para simplicidade, nas opções mantemos simples ou usamos Prism inline se houver <code>

            const onclick = isAnswered ? '' : `onclick="selectAnswer(${qId}, ${index})"`;
            const letters = ['A', 'B', 'C', 'D', 'E'];

            return `
                <div class="${optClass}" ${onclick}>
                    <span class="option-letter">${letters[index]}</span>
                    <span class="option-text">${text}</span>
                </div>
            `;
        }

        function createFeedback(isCorrect, correctText, explanation) {
            const icon = isCorrect ? 'Correcto!' : 'Errado!';

            return `
                <div class="feedback show ${isCorrect ? 'correct' : 'wrong'}">
                    <div class="feedback-header">
                        <span class="feedback-icon">${isCorrect ? '✅' : '❌'}</span>
                        ${icon}
                    </div>
                    <div style="margin-bottom:0.5rem">
                        ${isCorrect ? 'Muito bem!' : 'A resposta correta é: <strong>' + correctText + '</strong>'}
                    </div>
                    ${explanation ? `<div class="explanation">💡 <strong>Explicação:</strong> ${explanation}</div>` : ''}
                </div>
            `;
        }

        function selectAnswer(qId, optionIndex) {
            answers[qId] = optionIndex;
            saveProgress();
            renderQuestions(); // Re-render to show feedback and lock options
            updateStats();
        }

        function updateStats() {
            const total = Object.keys(answers).length;
            const correct = questions.filter(q => answers[q.id] === q.correct).length;
            const wrong = total - correct;
            const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;

            document.getElementById('total-answered').textContent = total;
            document.getElementById('total-correct').textContent = correct;
            document.getElementById('total-wrong').textContent = wrong;
            document.getElementById('percentage').textContent = percentage + '%';
            document.getElementById('progress-bar').style.width = (total / questions.length * 100) + '%';
        }

        function scrollToUnanswered() {
            const unanswered = questions.find(q => answers[q.id] === undefined);
            if (unanswered) {
                const element = document.getElementById(`question-${unanswered.id}`);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            } else {
                alert('🎉 Parabéns! Respondeste a todas as questões!');
            }
        }

        function resetQuiz() {
            if (confirm('Tens a certeza que queres reiniciar o quiz?')) {
                answers = {};
                localStorage.removeItem('quizProgressExtraIdentityV2');
                renderQuestions();
                updateStats();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function saveProgress() {
            localStorage.setItem('quizProgressExtraIdentityV2', JSON.stringify(answers));
        }

        function loadProgress() {
            const saved = localStorage.getItem('quizProgressExtraIdentityV2');
            if (saved) {
                answers = JSON.parse(saved);
            }
        }

        // ========================================================================
        // INICIALIZAÇÃO
        // ========================================================================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderQuestions();
            updateStats();
            document.getElementById('hide-answered').addEventListener('change', renderQuestions);
        });
    </script>
</body>

</html>